<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: main/attr.js</title>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="/styles/reset.css">
    <link type="text/css" rel="stylesheet" href="/styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="/amdquery/ui/css/widget-ui.css">
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <script src="scripts/amdquery.js" amdquery="debug:false;" amd="detectCR=1" module="transitionToAnimation:1" ui="initWidget:1;isTransform3d:0;autoFetchCss:0"> </script>
    <script src="scripts/main.js"> </script>
</head>

<body style="width: 100%; height: 100%;" onload="prettyPrint()">

<div id="main" style="width: 100%; height: 100%;" amdquery-widget="ui.scrollableview" ui-scrollableview="orientation:V;enableKeyboard:true;focus:true">

    <h1 id="page-title" name="page-title" class="page-title">Source: main/attr.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source">﻿aQuery.define( "main/attr", [ "base/typed", "base/extend", "base/support" ], function( $, typed, utilExtend, support, undefined ) {
	"use strict";
	//暂不要那么多hooks
	var fixSpecified = {
		name: true,
		id: true,
		coords: true
	},
		propFix = {
			tabindex: "tabIndex",
			readonly: "readOnly",
			"for": "htmlFor",
			"class": "className",
			maxlength: "maxLength",
			cellspacing: "cellSpacing",
			cellpadding: "cellPadding",
			rowspan: "rowSpan",
			colspan: "colSpan",
			usemap: "useMap",
			frameborder: "frameBorder",
			contenteditable: "contentEditable"
		}, rboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i;
	/**
	 * @exports main/attr
	 * @requires module:base/typed
	 * @requires module:base/extend
	 * @requires module:base/support
	 */
	var attrUtil = {
		/**
		 * @param {Element}
		 * @param {String}
		 * @returns {String}
		 */
		getAttr: function( ele, name ) {
			var ret;
			if ( !support.getSetAttribute ) {
				ret = ele.getAttributeNode( name );
				return ret && ( fixSpecified[ name ] ? ret.nodeValue !== "" : ret.specified ) ?
					ret.nodeValue :
					undefined;
			}
			return ( ret = ele.getAttributeNode( name ) ) ? ret.nodeValue : undefined;
		},
		/**
		 * Exception select, checkbox, radio. &lt;br/>
		 * If select is multiple choice, then return "America|England"
		 * @param {Element}
		 * @returns {String}
		 */
		getVal: function( ele ) {
			var type = ele.type.toUpperCase(),
				result;
			if ( typed.isNode( ele, "select" ) ) {
				result = ele.value;
				if ( typed.isNul( result ) || ele.multiple == true ) {
					result = [];
					$( ele ).posterity( ":selected" ).each( function( ele ) {
						result.push( ele.innerHTML );
					} );
					result = result.join( "|" );
				}
				return result;
			} else if ( typed.isNode( ele, "select" ) && ( type == "CHECKBOX" || type == "RADIO" ) )
				return ele.checked.toString();
			else
				return ele.value.toString();
		},
		/**
		 * @param {Element}
		 * @param {String}
		 * @returns {this}
		 */
		removeAttr: function( ele, key ) {
			var propName, attrNames, name, l, isBool, i = 0;

			if ( key && ele.nodeType === 1 ) {
				attrNames = key.toLowerCase().split( /\s+/ );
				l = attrNames.length;

				for ( ; i &lt; l; i++ ) {
					name = attrNames[ i ];

					if ( name ) {
						propName = propFix[ name ] || name;
						isBool = rboolean.test( name );

						if ( !isBool ) {
							attrUtil.setAttr( ele, name, "" );
						}
						ele.removeAttribute( support.getSetAttribute ? name : propName );

						if ( isBool && propName in ele ) {
							ele[ propName ] = false;
						}
					}
				}
			}
			return this;
		},
		/**
		 * @param {Element}
		 * @param {String}
		 * @param {String|Number}
		 * @returns {this}
		 */
		setAttr: function( ele, name, value ) {
			if ( value == null ) {
				return attrUtil.removeAttr( ele, name );
			}
			if ( !support.getSetAttribute ) {
				var ret = ele.getAttributeNode( name );
				if ( !ret ) {
					ret = document.createAttribute( name );
					ele.setAttributeNode( ret );
				}
				ret.nodeValue = value + "";
			} else {
				ele.setAttribute( name, value );
			}
			return this;
		},
		/**
		 * Exception select, checkbox, radio. &lt;br/>
		 * If select is multiple choice and value equals inner HTML of one element.
		 * @param {Element}
		 * @param {String|Boolean|Number}
		 * @returns {this}
		 */
		setVal: function( ele, value ) {
			var type = ele.type.toUpperCase();
			if ( typed.isNode( ele, "select" ) ) {
				if ( typed.isStr( value ) || typed.isNum( value ) )
					value = [ value ];
				$( ele ).find( "option" ).each( function( ele ) {
					ele.selected = false;
				} ).each( function( ele, index ) {
					$.each( value, function( val ) {
						if ( index === val || ele.innerHTML === val )
							ele.selected = true;
					}, this );
				} );
			} else if ( typed.isNode( ele, "input" ) && ( type == "CHECKBOX" || type == "RADIO" ) ) {
				if ( value === "checked" || value === "true" || value === true )
					ele.checked = true;
				else
					ele.value = value.toString();
			} else
				ele.value = value.toString();
			return this;
		}
	};

	$.fn.extend( /** @lends aQuery.prototype */ {
		/**
		 * Set or get attribute.
		 * @example
		 * $("#img").attr({
		 *   width: "100px",
		 *   height: "100px"
		 * }).attr("title", "Flower");
		 * $("#div1").attr("title", "Hello");
		 * $("#div2").attr("title", "World");
		 * $("#div1, #div2").attr("title"); // return "Hello"
		 * @param {String|Object}
		 * @param {String|Number} [value]
		 * @returns {this|String}
		 */
		attr: function( attr, value ) {
			if ( typed.isObj( attr ) ) {
				for ( var i in attr ) {
					this.each( function( ele ) {
						attrUtil.setAttr( ele, i, attr[ i ] );
					} );
				}
			} else if ( typed.isStr( attr ) ) {
				if ( value == undefined ) {
					return attrUtil.getAttr( this[ 0 ], attr );
				} else {
					this.each( function( ele ) {
						attrUtil.setAttr( ele, attr, value );
					} );
				}
			}
			return this;
		},
		/**
		 * Remove attribute.
		 * @param {String}
		 * @returns {this}
		 */
		removeAttr: function( name ) {
			return this.each( function( ele ) {
				attrUtil.removeAttr( ele, name );
			} );
		},
		/**
		 * Get or set value.
		 * @param {String|Boolean|Number} [value]
		 * @returns {this|String}
		 */
		val: function( value ) {
			return value ? this.each( function( ele ) {
				attrUtil.setVal( ele, value );
			} ) : attrUtil.getVal( this[ 0 ] );
		}
	} );

	return attrUtil;
} );</pre>
        </article>
    </section>





    <a float="false" href="#page-title" class="Top">Top</a>
</div>

<!--
<nav>
  <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="array.html">base/array</a></li><li><a href="ClassModule.html">base/ClassModule</a></li><li><a href="client.html">base/client</a></li><li><a href="config.html">base/config</a></li><li><a href="extend.html">base/extend</a></li><li><a href="Promise.html">base/Promise</a></li><li><a href="queue.html">base/queue</a></li><li><a href="ready.html">base/ready</a></li><li><a href="support.html">base/support</a></li><li><a href="typed.html">base/typed</a></li><li><a href="array_.html">ecma5/array</a></li><li><a href="function.html">ecma5/function</a></li><li><a href="object.html">ecma5/object</a></li><li><a href="string.html">ecma5/string</a></li><li><a href="charcode.html">hash/charcode</a></li><li><a href="cssColors.html">hash/cssColors</a></li><li><a href="applicationCache.html">html5/applicationCache</a></li><li><a href="localStorage.html">html5/localStorage</a></li><li><a href="sessionStorage.html">html5/sessionStorage</a></li><li><a href="Storage.html">html5/Storage</a></li><li><a href="Worker.html">html5/Worker</a></li><li><a href="sizzle.html">lib/sizzle</a></li><li><a href="attr.html">main/attr</a></li><li><a href="class.html">main/class</a></li><li><a href="communicate.html">main/communicate</a></li><li><a href="CustomEvent.html">main/CustomEvent</a></li><li><a href="data.html">main/data</a></li><li><a href="event.html">main/event</a></li><li><a href="object_.html">main/object</a></li><li><a href="parse.html">main/parse</a></li><li><a href="query.html">main/query</a></li><li><a href="event_.html">mobile/event</a></li><li><a href="location.html">module/location</a></li><li><a href="Test.html">module/Test</a></li></ul><h3>Classes</h3><ul><li><a href="aQuery.html">aQuery</a></li></ul><h3>Events</h3><ul><li><a href="aQuery.html#event:"ajaxStart"">"ajaxStart"</a></li><li><a href="aQuery.html#event:"ajaxStop"">"ajaxStop"</a></li><li><a href="aQuery.html#event:"ajaxTimeout"">"ajaxTimeout"</a></li><li><a href="aQuery.html#event:"jsonpStart"">"jsonpStart"</a></li><li><a href="aQuery.html#event:"jsonpStop"">"jsonpStop"</a></li><li><a href="aQuery.html#event:"jsonpTimeout"">"jsonpTimeout"</a></li><li><a href="aQuery.html#event:"test.report"">"test.report"</a></li></ul><h3>Namespaces</h3><ul><li><a href="aQuery.util.html">util</a></li><li><a href="event.document.html">document</a></li><li><a href="require.html">require(namespace)</a></li></ul><h3>Mixins</h3><ul><li><a href="CollectionClassPrototypeMethods.html">CollectionClassPrototypeMethods</a></li><li><a href="ObjectClassStaticMethods.html">ObjectClassStaticMethods</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AjaxOptions">AjaxOptions</a></li><li><a href="global.html#debug">debug</a></li><li><a href="global.html#define">define</a></li><li><a href="global.html#define">define(1)</a></li><li><a href="global.html#define">define(2)</a></li><li><a href="global.html#define">define(3)</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#info">info</a></li><li><a href="global.html#JSONPOptions">JSONPOptions</a></li><li><a href="global.html#logger">logger</a></li><li><a href="global.html#require">require</a></li></ul>
</nav>
-->

<br clear="both">

</body>
</html>
